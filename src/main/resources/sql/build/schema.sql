-- create SQL table for entity: DEPARTMENT

CREATE TABLE IF NOT EXISTS DEPARTMENT (
  ID BIGSERIAL NOT NULL ,
  NAME VARCHAR(50) NOT NULL ,
  CONSTRAINT pkdepid PRIMARY KEY (ID)
);

-- create SQL table for entity: STUDENT

CREATE TABLE IF NOT EXISTS STUDENT (
  ID BIGSERIAL NOT NULL ,
  FIRST_NAME VARCHAR(50) NOT NULL ,
  LAST_NAME VARCHAR(50) NOT NULL ,
  EMAIL VARCHAR(50) NOT NULL UNIQUE ,
  BIRTHDAY DATE NOT NULL ,
  PASSWORD VARCHAR(500) NOT NULL ,
  ROLE VARCHAR(255) NOT NULL ,
  PHOTO TEXT ,
  DEP_ID BIGINT NOT NULL ,
  CONSTRAINT pkstudid PRIMARY KEY (ID) ,
  CONSTRAINT fkstudid FOREIGN KEY (DEP_ID) REFERENCES DEPARTMENT (ID)
);

-- create SQL table for entity: SUBJECT

CREATE TABLE IF NOT EXISTS SUBJECT (
  ID BIGSERIAL NOT NULL ,
  NAME VARCHAR(50) NOT NULL ,
  CONSTRAINT pksubjid PRIMARY KEY (ID)
);

-- crate SQL table for entity: MARK

CREATE TABLE IF NOT EXISTS MARK (
  ID BIGSERIAL NOT NULL ,
  VALUE INT NOT NULL ,
  DATE DATE NOT NULL ,
  STUD_ID BIGINT NOT NULL ,
  SUBJ_ID BIGINT NOT NULL ,
  CONSTRAINT pkmarkid PRIMARY KEY (ID) ,
  CONSTRAINT fkmarkstudid FOREIGN KEY (STUD_ID) REFERENCES STUDENT (ID) ,
  CONSTRAINT fkmarksubjid FOREIGN KEY (SUBJ_ID) REFERENCES SUBJECT (ID)
);

-- create SQL extra table for linking entities SUBJECT and DEPARTMENT

CREATE TABLE IF NOT EXISTS SUBJECT_DEPARTMENT (
  SUB_ID BIGINT NOT NULL ,
  DEP_ID BIGINT NOT NULL ,
  CONSTRAINT fksubdepdepid FOREIGN KEY (DEP_ID) REFERENCES DEPARTMENT (ID) ,
  CONSTRAINT fksubdepsubjid FOREIGN KEY (SUB_ID) REFERENCES SUBJECT (ID) ,
  UNIQUE (SUB_ID, DEP_ID)
);

-- create SQL extra table for linking entities SUBJECT and STUDENT

CREATE TABLE IF NOT EXISTS SUBJECT_STUDENT (
  SUB_ID BIGINT NOT NULL ,
  STUD_ID BIGINT NOT NULL ,
  CONSTRAINT fksubstudsubid FOREIGN KEY (SUB_ID) REFERENCES SUBJECT (ID) ,
  CONSTRAINT fksubstudstudid FOREIGN KEY (STUD_ID) REFERENCES STUDENT (ID) ,
  UNIQUE (SUB_ID, STUD_ID)
);